# 图形的光栅转化

## 基本概念

#### 关于光栅图形

- 本质: 点阵表示
- 特点: 面着色，画面阴暗自然、色彩丰富
- 与线框图相比: 更加生动、直观、真实感强

## 多边形的扫描转换

#### 逐点判断算法
- 逐个像素判别其是否位于多边形内部
- 判断一个点是否位于多边形内部: **射线法**
 - 向右水平射线，判与多边形边的交点个数，奇数个在内，偶数个在外
 - 局部极值点算*2*, 否则算*1*

```c++
for (y = 0; y <= y_resolution; y++)
{
	for (x = 0; x <= x_resolution; x++)
	{
		if (inside(polygon, x + 0.5, y + 0.5))
		{
			setpixel(framebuffer, x, y, polygon_color)
		}
		else
		{
			setpixel(framebuffer, x, y, background_color)
		}
	}
}
```
 - 效率很低, 不可取!

#### 扫描线算法

- 相邻像素之间的连贯性
 - 区域连贯性: 多边形定义的区域内部相邻的像素具有相同的性质.
 	- 两条扫描线之间的长方形区域被分割成若干梯形
 - 扫描线连贯性
 - 边的连贯性
- 奇异点
 - 极值点: $\left(y_{i-1}-y_{i}\right)\left(y_{i+1}-y_{i}\right)\ge 0$
- 算法大致过程
 - 从小到上扫描, 计算扫描线*y=y_{min}*与多边形交点
 - 根据边连贯性, 从下到上得各扫描线交点
 - 填充内部直线段
- 数据结构
 - 边的数据结构
 	- *y_{max}*: 边上端点*y*坐标
	- *x*: 边下端点*x*坐标
	- *dx*: 边斜率倒数
	- *next*: 指向下一条边的指针
 - 分类的边表*ET*(*Sorted Edge Table*)记录多边形信息
 	- 水平边不加入
 - 活化边链表*AEL*(*Active Edge List*)记录当前扫描线信息
 	- 由当前与扫描线相交的多边形的边组成
	- 其中的*x*不再是边下端点，而是交点的*x*坐标
- 算法过程
 - 前置工作: 构造*ET*表
 - *y*初始化
 - *AEL*初始化
 - 扫描
 	- *a*)
	- *b*)
	- *c*)
	- *d*)
	- *e*)
